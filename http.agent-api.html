<html>
  <head>
    <title>clojure contrib - http.agent API reference</title>
    <link href="file/view/favicon.png" rel="icon" />
    <link href="file/view/favicon.png" rel="shortcut icon" />
    <link media="all" type="text/css" href="static/clojure.css" rel="stylesheet" />
    <link media="all" type="text/css" href="static/wiki.css" rel="stylesheet" />
    <link media="all" type="text/css" href="static/internal.css" rel="stylesheet" />
    <!-- TODO: are we using these (from clojure.org)? If so, add the files -->
    <script src="file/view/code_highlighter.js" type="text/javascript"></script>
    <script src="file/view/clojure.js" type="text/javascript"></script>
    <style>.menuWrapper{height: 36px;}</style>
    <!--[if lte IE 6]>
    <link rel="stylesheet" href="http://www.wikispaces.com/_/2009051601/s/internal_ie.css" type="text/css" />
    <![endif]-->
  </head>
<!--
This document was auto-generated from the clojure.contrib source by contrib-autodoc.
To report errors or ask questions about the overall documentation structure, formatting,
etc., contact Tom Faulhaber (google mail name: tomfaulhaber).
For errors in the documentation of a particular namespace, contact the author of that
namespace.
-->
  <body>
    <div id="AllContentContainer">
      <div id="Header">
	<a id="Logo" href="index.html"><img alt="Clojure" height="100" width="100" src="file/view/clojure-icon.gif" /></a>
	<h1><a title="Clojure" href="index.html">Clojure</a></h1>
      </div>
      <div id="leftcolumn"><div><div style="text-align: center;"></div>
<div class="menu">
  <div class="WikiCustomNav WikiElement wiki">
    <a class="wiki_link" href="index.html">Overview</a><br />
    <a class="wiki_link" href="api-index.html">API Index</a><br />
    <a class="wiki_link" href="#">Namespaces:</a>
    <ul id="left-sidebar-list">
      <li><a href="accumulators-api.html" class="wiki_link">accumulators</a></li><li><a href="agent-utils-api.html" class="wiki_link">agent-utils</a></li><li><a href="classpath-api.html" class="wiki_link">classpath</a></li><li><a href="combinatorics-api.html" class="wiki_link">combinatorics</a></li><li><a href="command-line-api.html" class="wiki_link">command-line</a></li><li><a href="complex-numbers-api.html" class="wiki_link">complex-numbers</a></li><li><a href="cond-api.html" class="wiki_link">cond</a></li><li><a href="condition-api.html" class="wiki_link">condition</a></li><li><a href="core-api.html" class="wiki_link">core</a></li><li><a href="dataflow-api.html" class="wiki_link">dataflow</a></li><li><a href="datalog-api.html" class="wiki_link">datalog</a></li><li><a href="def-api.html" class="wiki_link">def</a></li><li><a href="duck-streams-api.html" class="wiki_link">duck-streams</a></li><li><a href="error-kit-api.html" class="wiki_link">error-kit</a></li><li><a href="except-api.html" class="wiki_link">except</a></li><li><a href="fcase-api.html" class="wiki_link">fcase</a></li><li><a href="find-namespaces-api.html" class="wiki_link">find-namespaces</a></li><li><a href="fnmap-api.html" class="wiki_link">fnmap</a></li><li><a href="gen-html-docs-api.html" class="wiki_link">gen-html-docs</a></li><li><a href="generic.arithmetic-api.html" class="wiki_link">generic.arithmetic</a></li><li><a href="generic.collection-api.html" class="wiki_link">generic.collection</a></li><li><a href="generic.comparison-api.html" class="wiki_link">generic.comparison</a></li><li><a href="generic.functor-api.html" class="wiki_link">generic.functor</a></li><li><a href="generic.math-functions-api.html" class="wiki_link">generic.math-functions</a></li><li><a href="graph-api.html" class="wiki_link">graph</a></li><li><a href="greatest-least-api.html" class="wiki_link">greatest-least</a></li><li><a href="http.agent-api.html" class="wiki_link">http.agent</a></li><li><a href="http.connection-api.html" class="wiki_link">http.connection</a></li><li><a href="import-static-api.html" class="wiki_link">import-static</a></li><li><a href="jar-api.html" class="wiki_link">jar</a></li><li><a href="java-utils-api.html" class="wiki_link">java-utils</a></li><li><a href="javadoc.browse-api.html" class="wiki_link">javadoc.browse</a></li><li><a href="jmx-api.html" class="wiki_link">jmx</a></li><li><a href="json.read-api.html" class="wiki_link">json.read</a></li><li><a href="json.write-api.html" class="wiki_link">json.write</a></li><li><a href="lazy-seqs-api.html" class="wiki_link">lazy-seqs</a></li><li><a href="lazy-xml-api.html" class="wiki_link">lazy-xml</a></li><li><a href="logging-api.html" class="wiki_link">logging</a></li><li><a href="macro-utils-api.html" class="wiki_link">macro-utils</a></li><li><a href="macros-api.html" class="wiki_link">macros</a></li><li><a href="map-utils-api.html" class="wiki_link">map-utils</a></li><li><a href="math-api.html" class="wiki_link">math</a></li><li><a href="miglayout-api.html" class="wiki_link">miglayout</a></li><li><a href="mmap-api.html" class="wiki_link">mmap</a></li><li><a href="monadic-io-streams-api.html" class="wiki_link">monadic-io-streams</a></li><li><a href="monads-api.html" class="wiki_link">monads</a></li><li><a href="ns-utils-api.html" class="wiki_link">ns-utils</a></li><li><a href="pprint-api.html" class="wiki_link">pprint</a></li><li><a href="probabilities.finite-distributions-api.html" class="wiki_link">probabilities.finite-distributions</a></li><li><a href="probabilities.monte-carlo-api.html" class="wiki_link">probabilities.monte-carlo</a></li><li><a href="probabilities.random-numbers-api.html" class="wiki_link">probabilities.random-numbers</a></li><li><a href="profile-api.html" class="wiki_link">profile</a></li><li><a href="prxml-api.html" class="wiki_link">prxml</a></li><li><a href="repl-ln-api.html" class="wiki_link">repl-ln</a></li><li><a href="repl-utils-api.html" class="wiki_link">repl-utils</a></li><li><a href="seq-utils-api.html" class="wiki_link">seq-utils</a></li><li><a href="server-socket-api.html" class="wiki_link">server-socket</a></li><li><a href="set-api.html" class="wiki_link">set</a></li><li><a href="shell-out-api.html" class="wiki_link">shell-out</a></li><li><a href="singleton-api.html" class="wiki_link">singleton</a></li><li><a href="sql-api.html" class="wiki_link">sql</a></li><li><a href="str-utils-api.html" class="wiki_link">str-utils</a></li><li><a href="str-utils2-api.html" class="wiki_link">str-utils2</a></li><li><a href="stream-utils-api.html" class="wiki_link">stream-utils</a></li><li><a href="swing-utils-api.html" class="wiki_link">swing-utils</a></li><li><a href="trace-api.html" class="wiki_link">trace</a></li><li><a href="types-api.html" class="wiki_link">types</a></li><li><a href="with-ns-api.html" class="wiki_link">with-ns</a></li><li><a href="zip-filter-api.html" class="wiki_link">zip-filter</a></li>
    </ul>
  </div>
</div>
</div></div>
      <div id="rightcolumn">
	<div id="Content">
	  <div class="contentBox"><div class="innerContentBox">
              <div id="content_view" class="wiki wikiPage">
                <!-- Temporary disclaimer -->
                <div style="background-color: #FF0000; font-weight: bold;">
                  NOTE: These autogen pages are still under development. 
                  Not all links work. Not all formatting is done.
                  Contact Tom Faulhaber (tomfaulhaber on github, gmail, etc.)
                  with any questions.
                </div>
                <div id="right-sidebar"><div><div id="toc">
  <h1 class="nopad">Table of Contents</h1>
  <div style="margin-left: 1em;" class="toc-section">
    <a href="#toc0">Overview</a>
    <div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/buffer-bytes">buffer-bytes</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/client-error?">client-error?</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/error?">error?</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/http-agent">http-agent</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/redirect?">redirect?</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/response-body-bytes">response-body-bytes</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/response-body-str">response-body-str</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/response-body-stream">response-body-stream</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/response-headers">response-headers</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/response-headers-seq">response-headers-seq</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/response-message">response-message</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/response-status">response-status</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/result">result</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/server-error?">server-error?</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#http.agent/success?">success?</a>
    </div>
    <br />
  </div>
</div>
</div></div>
                <div id="content-tag"><div><h1 id="overview">API for <span id="namespace-name">http.agent</span></h1>
by <span id="author">Unknown</span><br />
<br />Usage:
<pre>
(ns your-namespace
  (:require <span id="long-name">clojure.contrib.http.agent</span>))
</pre><pre>
</pre><h2>Overview</h2>
<pre id="namespace-docstr">Agent-based asynchronous HTTP client.</pre>
<br />
<h2>Public Variables and Functions</h2>
<div id="var-entry">
  <hr />
  <h2 id="http.agent/buffer-bytes">buffer-bytes</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (buffer-bytes http-agnt)
</pre>
  <pre id="var-docstr">The default HTTP agent result handler; it collects the response
body in a java.io.ByteArrayOutputStream.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L73" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/client-error?">client-error?</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (client-error? http-agnt)
</pre>
  <pre id="var-docstr">Returns true if the HTTP response code was in the 400-499 range.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L243" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/error?">error?</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (error? http-agnt)
</pre>
  <pre id="var-docstr">Returns true if the HTTP response code was in the 400-499 range OR
the 500-599 range.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L253" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/http-agent">http-agent</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (http-agent url &amp; options)
</pre>
  <pre id="var-docstr">Creates (and immediately returns) an Agent representing an HTTP
request running in a new thread.

options are key/value pairs:

:method string

The HTTP method name.  Default is "GET".

:headers h

HTTP headers, as a Map or a sequence of pairs like 
([key1,value1], [key2,value2])  Default is nil.

:body b

HTTP request entity body, one of nil, String, byte[], InputStream,
Reader, or File.  Default is nil.

:connect-timeout int

Timeout value, in milliseconds, when opening a connection to the
URL.  Default is zero, meaning no timeout.

:read-timeout int

Timeout value, in milliseconds, when reading data from the
connection.  Default is zero, meaning no timeout.

:follow-redirects boolean

If true, HTTP 3xx redirects will be followed automatically.  Default
is true.

:on-success f

Function to be called when the request succeeds with a 2xx response
code.  The function will be called with the HTTP agent as its
argument, and can use the response-body-stream function to read the
response body.  The return value of this function will be stored in
the state of the agent and can be retrieved with the 'result'
function.  Any exceptions thrown by this function will be added to
the agent's error queue (see agent-errors).  The default function
collects the response stream into a byte array.

:on-failure f

Like :on-success but this function will be called when the request
fails with a 4xx or 5xx response code.
</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L91" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/redirect?">redirect?</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (redirect? http-agnt)
</pre>
  <pre id="var-docstr">Returns true if the HTTP response code was in the 300-399 range.

Note: if the :follow-redirects option was true (the default),
redirects will be followed automatically and a the agent will never
return a 3xx response code.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L234" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/response-body-bytes">response-body-bytes</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (response-body-bytes http-agnt)
</pre>
  <pre id="var-docstr">Returns a Java byte array of the content returned by the server;
nil if the content is not yet available.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L165" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/response-body-str">response-body-str</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (response-body-str http-agnt)
       (response-body-str http-agnt encoding)
</pre>
  <pre id="var-docstr">Returns the HTTP response body as a string, using the given
encoding.

If no encoding is given, uses the encoding specified in the server
headers, or clojure.contrib.duck-streams/*default-encoding* if it is
not specified.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L174" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/response-body-stream">response-body-stream</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (response-body-stream http-agnt)
</pre>
  <pre id="var-docstr">Returns an InputStream of the HTTP response body.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L65" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/response-headers">response-headers</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (response-headers a)
</pre>
  <pre id="var-docstr">Returns a String=&gt;String map of HTTP response headers.  Header
names are converted to all lower-case.  If a header appears more
than once, only the last value is returned.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L203" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/response-headers-seq">response-headers-seq</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (response-headers-seq http-agnt)
</pre>
  <pre id="var-docstr">Returns the HTTP response headers in order as a sequence of
[String,String] pairs.  The first 'header' name may be null for the
HTTP status line.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L212" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/response-message">response-message</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (response-message a)
</pre>
  <pre id="var-docstr">Returns the HTTP response message (e.g. 'Not Found'), for this request.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L197" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/response-status">response-status</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (response-status a)
</pre>
  <pre id="var-docstr">Returns the Integer response status code (e.g. 200, 404) for this request.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L191" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/result">result</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (result http-agnt)
</pre>
  <pre id="var-docstr">Returns the value returned by the :on-success or :on-failure
handler function of the HTTP agent; nil if the handler function has
not yet finished.  The default handler function returns a
ByteArrayOutputStream.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L156" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/server-error?">server-error?</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (server-error? http-agnt)
</pre>
  <pre id="var-docstr">Returns true if the HTTP response code was in the 500-599 range.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L248" id="var-source">Source</a>
</div><div id="var-entry">
  <hr />
  <h2 id="http.agent/success?">success?</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (success? http-agnt)
</pre>
  <pre id="var-docstr">Returns true if the HTTP response code was in the 200-299 range.</pre>
  <a href="http://github.com/richhickey/clojure-contrib/blob/ed89b92ef38056520a1cd7cfb725a4d6cedf980b/src/clojure/contrib/http/agent.clj#L229" id="var-source">Source</a>
</div>


</div></div>
              </div>
            </div>
          </div>
	</div>
	<div id="foot">
	  <div style="text-align: center;">
            Copyright 2008-2009 Rich Hickey and the various contributors
          </div>
	</div>
      </div>
      <div id="DesignedBy">Logo &amp; site design by <a title="Visit Tom Hickey's website." href="http://www.tomhickey.com">Tom Hickey</a>.</div>
    </div>
    <!-- /AllContentContainer -->
  </body>

</html>